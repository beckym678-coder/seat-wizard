<!DOCTYPE html>
<html>
<head>
  <base target="_top">
  <style>
    body { font-family: Arial, sans-serif; padding: 12px; }
    h3 { color: #1a73e8; }
    label { display: block; margin-top: 10px; }
    input[type="number"], textarea { 
      width: 100%; 
      padding: 6px; 
      margin-top: 4px; 
      font-size: 14px; 
    }
    textarea { height: 100px; resize: vertical; }

    button {
      margin-top: 12px;
      background: #1a73e8;
      color: white;
      border: none;
      padding: 7px 10px;
      border-radius: 4px;
      cursor: pointer;
      width: 100%;
      font-size: 14px;
    }
    button:hover { background: #0f5fc2; }

    .secondary {
      background: #5f6368;
    }
    .secondary:hover {
      background: #4a4d50;
    }

    #status { margin-top: 12px; font-size: 13px; }
  </style>
</head>
<body>
  <h3>üé≤ Random Group Generator</h3>
  <h2> Still under development</h2>

  <!-- MODE SELECTION -->
  <label><input type="radio" name="mode" value="count" checked> Number of groups</label>
  <input type="number" id="groupCount" min="1" placeholder="e.g. 5" oninput="updateNames()">

  <label><input type="radio" name="mode" value="size"> Max people per group</label>
  <input type="number" id="groupSize" min="2" placeholder="e.g. 4" oninput="updateNames()">

  <!-- GROUP NAMES -->
  <label>Group Names (optional, one per line):</label>
  <textarea id="groupNames" placeholder="Group 1\nGroup 2\nGroup 3..."></textarea>

  <!-- BUTTONS -->
  <button onclick="makeGroups()">Generate Groups</button>

  <button class="secondary" onclick="makeGroupsForAllClasses()">Generate Groups for All Classes</button>

  <div id="status"></div>

  <script>
    // Auto-generate group names when number-of-groups mode is used
    function updateNames() {
      const mode = document.querySelector('input[name="mode"]:checked').value;
      const count = parseInt(document.getElementById('groupCount').value);
      const box = document.getElementById('groupNames');

      if (mode === 'count' && count > 0) {
        box.value = Array.from({ length: count }, (_, i) => `Group ${i + 1}`).join('\n');
      }
    }

    // Generate for selected class
    function makeGroups() {
      const mode = document.querySelector('input[name="mode"]:checked').value;
      const count = document.getElementById('groupCount').value;
      const size = document.getElementById('groupSize').value;
      const names = document.getElementById('groupNames').value.trim().split(/\n+/).filter(Boolean);
      const status = document.getElementById('status');

      status.textContent = '‚è≥ Generating groups...';

      google.script.run
        .withSuccessHandler(url => {
          status.innerHTML = `‚úÖ Groups created! <a href="${url}" target="_blank">View Slide</a>`;
        })
        .withFailureHandler(err => {
          status.textContent = '‚ùå ' + (err.message || err);
        })
        .generateRandomGroups(mode, count, size, names);
    }

    // NEW: Generate for ALL classes
    function makeGroupsForAllClasses() {
      const mode = document.querySelector('input[name="mode"]:checked').value;
      const count = document.getElementById('groupCount').value;
      const size = document.getElementById('groupSize').value;
      const names = document.getElementById('groupNames').value.trim().split(/\n+/).filter(Boolean);
      const status = document.getElementById('status');

      status.textContent = '‚è≥ Generating groups for ALL classes...';

      google.script.run
        .withSuccessHandler(url => {
          status.innerHTML = `‚úÖ All-class groups created! <a href="${url}" target="_blank">View Slide</a>`;
        })
        .withFailureHandler(err => {
          status.textContent = '‚ùå ' + (err.message || err);
        })
        .generateRandomGroupsForAllClasses(mode, count, size, names);
    }
  </script>
</body>
</html>
